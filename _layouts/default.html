<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="google-site-verification" content="WF_xeelgVD-KNxUczjdZPXC2spg9YFtg4MCl7nrflps" />
{% if page.doi %}
  {% assign raw_doi = page.doi | strip %}

  {% comment %}
  Normalize DOI:
  - If it's already a DOI string, use it as-is
  - If it's a URL (dx.doi.org or doi.org), extract the DOI
  {% endcomment %}

  {% if raw_doi contains "doi.org/" %}
    {% assign doi = raw_doi | split: "doi.org/" | last %}
  {% elsif raw_doi contains "dx.doi.org/" %}
    {% assign doi = raw_doi | split: "dx.doi.org/" | last %}
  {% else %}
    {% assign doi = raw_doi %}
  {% endif %}

  {% assign doi_url = "https://doi.org/" | append: doi %}
{% endif %}

{% seo %}
    <link rel="stylesheet" href="{{ "/assets/css/style.css?v=" | append: site.github.build_revision | relative_url }}">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    {% include head-custom.html %}

{%- assign cat = page.category | default: "" | downcase -%}
{%- capture cc_type -%}
{%- case cat -%}
  {%- when "papers" -%}ScholarlyArticle
  {%- when "" -%}WebPage
  {%- else -%}TechArticle
{%- endcase -%}
{%- endcapture -%}

{%- comment -%}
Supplemental JSON-LD: additive metadata not supplied by jekyll-seo-tag.
Do NOT repeat headline/description/date/url here; jekyll-seo-tag already supplies them.
{%- endcomment -%}

{% assign canonical_pdf_url = page.canonical_pdf_url | default: page.pdf_url %}
{% assign has_identifiers = false %}
{% if page.item_id or doi %}{% assign has_identifiers = true %}{% endif %}

{% if has_identifiers or page.version or canonical_pdf_url %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@id": {{ page.url | absolute_url | jsonify }}
  {%- if has_identifiers -%},
  "identifier": [
    {%- if page.item_id -%}{{ page.item_id | jsonify }}{%- endif -%}
    {%- if page.item_id and doi -%},{%- endif -%}
    {%- if doi -%}{{ doi_url | jsonify }},{{ doi | jsonify }}{%- endif -%}
  ]
  {%- endif -%}
  {%- if page.version -%},
  "version": {{ page.version | jsonify }}
  {%- endif -%}
  {%- if canonical_pdf_url -%},
  "encoding": {
    "@type": "MediaObject",
    "encodingFormat": "application/pdf",
    "contentUrl": {{ canonical_pdf_url | absolute_url | jsonify }}
  }
  {%- endif -%}
}
</script>
{% endif %}

    {% if doi %}
      <meta name="citation_doi" content="{{ doi }}">
      <meta name="dc.identifier" content="doi:{{ doi }}">
    {% endif %}
    {% if page.item_id %}
      <meta name="dc.identifier" content="{{ page.item_id | escape }}">
      <meta name="citation_id" content="{{ page.item_id | escape }}">
    {% endif %}
    {% if page.title %}
    <meta name="citation_title" content="{{ page.title | escape }}">
    {% endif %}
    {% if page.author %}
    {% if page.author.size %}
      {% for a in page.author %}
      <meta name="citation_author" content="{{ a | escape }}">
      {% endfor %}
    {% else %}
      <meta name="citation_author" content="{{ page.author | escape }}">
    {% endif %}
    {% endif %}
    {% if page.date %}
    <meta name="citation_publication_date" content="{{ page.date }}">
    {% endif %}
    {% if page.journal_title %}
    <meta name="citation_journal_title" content="{{ page.journal_title | escape }}">
    {% else %}
    <meta name="citation_journal_title" content="Codecraft Papers">
    {% endif %}
    {% if canonical_pdf_url %}
      <meta name="citation_pdf_url" content="{{ canonical_pdf_url }}">
    {% endif %}
    {% if page.abstract %}
    <meta name="citation_abstract" content="{{ page.abstract | escape }}">
    {% endif %}
    {% if page.keywords %}
    <meta name="citation_keywords" content="{{ page.keywords | escape }}">
    {% endif %}
    {% if page.language %}
    <meta name="citation_language" content="{{ page.language }}">
    {% endif %}
    {% if page.publisher %}
    <meta name="citation_publisher" content="{{ page.publisher | escape }}">
    {% else %}
    <meta name="citation_publisher" content="Codecraft">
    {% endif %}
    {% if page.version %}
    <meta name="citation_version" content="{{ page.version | escape }}">
    {% endif %}
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1><a href="{{ "/" | absolute_url }}">{{ site.title | default: site.github.repository_name }}</a></h1>
        {% if site.logo %}
          <img src="{{site.logo}}" alt="Logo" />
        {% endif %}
        <p>{{ site.description | default: site.github.project_tagline }}</p>
      </header>
      <section>
      <p class="not-printed"><a href="{{ '/' | absolute_url }}">&larr; back</a></p>
      {% if page.title %}
      <h1>{{ page.title }}</h1>
      {% endif %}
      {% if doi or page.item_id or page.version or canonical_pdf_url %}
      <div class="pubmeta">
        <p>
          {% if doi %}
            <span class="meta-label">DOI:</span>
            <a href="{{ doi_url }}" rel="external">{{ doi }}</a>
            {% if page.item_id or page.version or canonical_pdf_url %}
              <span class="meta-sep"> · </span>
            {% endif %}
          {% endif %}

          {% if page.item_id %}
            <span class="meta-label">Item ID:</span>
            <span class="meta-mono">{{ page.item_id }}</span>
            {% if page.version or canonical_pdf_url %}
              <span class="meta-sep"> · </span>
            {% endif %}
          {% endif %}

          {% if page.version %}
            <span class="meta-label">Version:</span>
            <span class="meta-mono">{{ page.version }}</span>
            {% if canonical_pdf_url %}
              <span class="meta-sep"> · </span>
            {% endif %}
          {% endif %}

          {% if canonical_pdf_url %}
            <span class="meta-label">Canonical PDF:</span>
            <a href="{{ canonical_pdf_url | absolute_url }}">Download</a>
          {% endif %}
        </p>
      </div>
      {% endif %}
      {% if page.abstract %}
      <details class="abstract" open>
        <summary class="h3">Abstract</summary>
        <p>{{ page.abstract }}</p>
      </details>
      {% endif %}
      {% if page.keywords %}
      <details class="keywords" open>
        <summary class="h3">Keywords</summary>
        <p>{{ page.keywords }}</p>
      </details>
      {% endif %}
      {{ content }}
      </section>
      <footer>
Content copyrighted with a <a href="https://creativecommons.org/licenses/by/4.0/deed.en">CC BY 4.0 license</a>, unless otherwise noted. A version history for each item is maintained in <a href="https://github.com/dhh1128/papers">GitHub</a>. <a href="https://github.com/dhh1128/papers/issues/new">Reports of errata</a> are welcome.
      </footer>
    </div>
  </body>
</html>